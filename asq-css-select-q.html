<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../asq-base/asq-base.html">

<link rel="import" href="elements/asq-css-select-q-viewer/asq-css-select-q-viewer.html">
<link rel="import" href="elements/asq-css-select-q-presenter/asq-css-select-q-presenter.html">

<dom-module id="asq-css-select-q">

  <template>
    <template is="dom-if" if="{{hasRole(role, roles.VIEWER)}}" restamp="true">
      <asq-css-select-q-viewer 
        role="viewer" 
        uid="[[uid]]"
        htmlcode="{{htmlcode}}" 
        disabled="{{disabled}}"
        value="{{value}}" 
        event-bus="[[eventBus]]">
        <content></content>
      </asq-css-select-q-viewer>
    </template>

    <template is="dom-if" if="{{hasRole(role, roles.PRESENTER)}}" restamp="true">
      <asq-css-select-q-presenter 
        role="presenter" 
        uid="[[uid]]" 
        htmlcode="{{htmlcode}}" 
        disabled="{{disabled}}"
        value="{{value}}" 
        event-bus="[[eventBus]]">
        <content></content>
      </asq-css-select-q-presenter>
    </template>

  </template>

  <script>
    Polymer({
      is: 'asq-css-select-q',

      behaviors: [ASQ.asqQuestionElementBehavior],

      properties: {
        /**
         * Event bus to communicate with ASQ
         */
        eventBus: {
          type: Object,
          notify: true
        }
      },

      created: function () {
        document.addEventListener('asq-ready', function (evt) {
          this.eventBus = evt.detail.asqEventBus
        }.bind(this));
      },

      submit: function () {
        if (this.role == this.roles.VIEWER) {
          var el = this.$$('asq-css-select-q-viewer');
          if (!el) {
            throw new Error('submit(): expected asq-css-select-q-viewer element to exist');
          }
          return el.submit();
        }
      }
    });
  </script>
</dom-module>
